
import { Gender } from "../types";

// Tỷ lệ phí (Đơn vị: phần nghìn của STBH)
// Dữ liệu từ bảng PRU - ĐẦU TƯ VỮNG TIẾN
const RATE_TABLE: Record<Gender, Record<number, number>> = {
    [Gender.MALE]: {
        0: 16.26, 1: 16.31, 2: 16.36, 3: 16.41, 4: 16.46, 5: 16.51, 6: 16.61, 7: 16.71, 8: 16.81, 9: 16.91,
        10: 17.02, 11: 17.12, 12: 17.23, 13: 17.34, 14: 17.45, 15: 17.56, 16: 17.61, 17: 17.65, 18: 17.70, 19: 17.75,
        20: 17.80, 21: 17.85, 22: 17.90, 23: 17.95, 24: 18.00, 25: 18.05, 26: 18.12, 27: 18.19, 28: 18.27, 29: 18.34,
        30: 18.41, 31: 18.49, 32: 18.56, 33: 18.64, 34: 18.72, 35: 18.79, 36: 19.43, 37: 20.10, 38: 20.83, 39: 21.61,
        40: 22.45, 41: 23.36, 42: 24.34, 43: 25.41, 44: 26.58, 45: 27.86, 46: 28.80, 47: 29.79, 48: 30.86, 49: 32.01,
        50: 33.25, 51: 34.59, 52: 36.04, 53: 37.62, 54: 39.34, 55: 41.22, 56: 42.66, 57: 44.19, 58: 45.84, 59: 47.62,
        60: 49.54, 61: 51.62, 62: 53.89, 63: 56.36, 64: 59.08, 65: 62.06, 66: 65.74, 67: 69.89, 68: 74.59, 69: 79.97,
        70: 86.19
    },
    [Gender.FEMALE]: {
        0: 11.11, 1: 11.14, 2: 11.16, 3: 11.19, 4: 11.21, 5: 11.23, 6: 11.29, 7: 11.34, 8: 11.39, 9: 11.44,
        10: 11.50, 11: 11.55, 12: 11.61, 13: 11.66, 14: 11.72, 15: 11.77, 16: 11.81, 17: 11.85, 18: 11.89, 19: 11.93,
        20: 11.97, 21: 12.01, 22: 12.06, 23: 12.10, 24: 12.14, 25: 12.18, 26: 12.22, 27: 12.25, 28: 12.29, 29: 12.32,
        30: 12.36, 31: 12.39, 32: 12.43, 33: 12.47, 34: 12.50, 35: 12.54, 36: 12.94, 37: 13.37, 38: 13.83, 39: 14.32,
        40: 14.85, 41: 15.42, 42: 16.04, 43: 16.70, 44: 17.42, 45: 18.21, 46: 18.84, 47: 19.51, 48: 20.23, 49: 21.01,
        50: 21.85, 51: 22.76, 52: 23.75, 53: 24.83, 54: 26.01, 55: 27.31, 56: 28.34, 57: 29.45, 58: 30.65, 59: 31.95,
        60: 33.36, 61: 34.91, 62: 36.61, 63: 38.48, 64: 40.55, 65: 42.86, 66: 45.94, 67: 49.50, 68: 53.66, 69: 58.59,
        70: 64.50
    },
    [Gender.OTHER]: {} // Fallback
};

export const calculateDauTuVungTien = (age: number, gender: Gender, sumAssured: number): number => {
    // Default to Male table if Other/Undefined
    const table = RATE_TABLE[gender === Gender.FEMALE ? Gender.FEMALE : Gender.MALE];
    const rate = table[age];

    if (rate === undefined) return 0;

    // Công thức: (STBH / 1000) * Tỷ lệ
    return Math.round((sumAssured / 1000) * rate);
};
